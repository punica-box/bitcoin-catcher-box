window.__require=function t(e,n,o){function r(c,s){if(!n[c]){if(!e[c]){var a=c.split("/");if(a=a[a.length-1],!e[a]){var u="function"==typeof __require&&__require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+c+"'")}}var l=n[c]={exports:{}};e[c][0].call(l.exports,function(t){return r(e[c][1][t]||t)},l,l.exports,t,e,n,o)}return n[c].exports}for(var i="function"==typeof __require&&__require,c=0;c<o.length;c++)r(o[c]);return r}({1:[function(t,e,n){e.exports=function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="./src/index.ts")}({"./src/CyanoBridge.ts":function(t,e,n){"use strict";n.r(e);var o=n("./src/utils.ts");e.default=class{constructor(t){this.timeout=3e3,this.version="v1.0.0",this.handlers={},t&&(this.timeout=t),this.injected=!1,this.pendingMsgs=[]}call(t){const e=Object(o.randomId)();return t.id=e,new Promise((n,o)=>{const r="ontprovider://ont.io?params="+btoa(encodeURIComponent(JSON.stringify(t)));this.sendMessage(r),this.handleMessageEvent(e,n,o,t.action,t.needTimeout)})}invokeRead(){throw new Error("invokeRead not supported yet.")}parseMessage(t){return JSON.parse(decodeURIComponent(atob(t)))}onMessage(t){this.listener&&this.offMessage();const e=e=>{const n=this.parseMessage(e.data);t(n)};window.document.addEventListener("message",e),this.listener=e}offMessage(){window.document.removeEventListener("message",this.listener)}sendMessage(t){this.injected?window.postMessage(t,"*"):this.checkInterval?this.pendingMsgs.push(t):this.checkInterval=window.setInterval(()=>{window.originalPostMessage&&(window.postMessage(t,"*"),this.injected=!0,this.pendingMsgs.forEach(t=>{window.postMessage(t,"*")}),window.clearInterval(this.checkInterval))},100)}handleMessageEvent(t,e,n,o,r=!1){const i=this,c=function(t){const r=t.data;r||n(t);const s=i.parseMessage(r);s.id||n("No message id"),i.handlers[s.id]||n("No message handler"),s.id===c.id&&(document.removeEventListener("message",i.handlers[s.id]),delete i.handlers[s.id],s.action===o?e(s):n(s))};c.id=t,this.handlers[t]=c,document.addEventListener("message",this.handlers[t]),r&&setTimeout(()=>{n("Time out")},this.timeout)}}},"./src/client/asset.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"assetApi",function(){return i});var o=n("./src/client/proxy.ts"),r=n("./src/client/smartcontract.ts");const i={getAccount(t){const e={action:"getAccount",version:o.version,params:t,needTimeout:!0};return Object(o.call)(e)},transfer({from:t,to:e,asset:n,amount:o,gasPrice:i,gasLimit:c}){const s={scriptHash:"ONT"===n?"0100000000000000000000000000000000000000":"0200000000000000000000000000000000000000",operation:"transfer",args:[{name:"from",type:"Address",value:t},{name:"to",type:"Address",value:e},{name:"amount",type:"Long",value:o}],gasPrice:500,gasLimit:2e4,payer:t};return r.scApi.invoke(s)}}},"./src/client/identity.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"identityApi",function(){return i});var o=n("./src/client/proxy.ts"),r=n("./src/client/smartcontract.ts");const i={getIdentity(t){const e={action:"getIdentity",version:o.version,params:t,needTimeout:!0};return Object(o.call)(e)},authentication(t){const e={action:"authentication",version:o.version,params:t};return Object(o.call)(e)},authorization(t){const e={action:"authorization",version:o.version,params:t};return Object(o.call)(e)},registerOntId({ontid:t,publicKey:e,payer:n,gasPrice:o,gasLimit:i}){const c={scriptHash:"0300000000000000000000000000000000000000",operation:"regIDWithPublicKey",args:[{name:"ontid",type:"String",value:t},{name:"pk",type:"ByteArray",value:e}],gasPrice:500,gasLimit:2e4,payer:n};return r.scApi.invoke(c)},getDDO(t){const e={scriptHash:"0300000000000000000000000000000000000000",operation:"getDDO",args:[{name:"ontid",type:"String",value:t}],gasPrice:500,gasLimit:2e4};return r.scApi.invokeRead(e)}}},"./src/client/index.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"api",function(){return l});var o=n("./src/client/asset.ts"),r=n("./src/client/identity.ts"),i=n("./src/client/message.ts"),c=n("./src/client/provider.ts"),s=n("./src/client/qrcode.ts"),a=n("./src/client/smartcontract.ts"),u=n("./src/client/proxy.ts");n.d(e,"registerClient",function(){return u.registerClient});const l={asset:o.assetApi,identity:r.identityApi,message:i.messageApi,smartContract:a.scApi,qrcode:s.qrcodeApi,provider:c.providerApi}},"./src/client/message.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"messageApi",function(){return r});var o=n("./src/client/proxy.ts");const r={signMessage(t){const e={action:"signMessage",version:o.version,params:t,needTimeout:!1};return Object(o.call)(e)},login(t){if(!t.message||"string"!=typeof t.message)throw new Error("Parameter for login must contain a message.");t.type||(t.type="account");const e={action:"login",version:o.version,params:t,needTimeout:!1};return Object(o.call)(e)}}},"./src/client/provider.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"providerApi",function(){return r});var o=n("./src/client/proxy.ts");const r={getProvider(){const t={action:"getProvider",version:o.version,needTimeout:!0};return Object(o.call)(t)}}},"./src/client/proxy.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"registerClient",function(){return i}),n.d(e,"call",function(){return c}),n.d(e,"version",function(){return s});var o=n("./src/CyanoBridge.ts");let r;function i(t=3e3){r=new o.default(t)}async function c(t){return r.call(t)}const s="1.0.0"},"./src/client/qrcode.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"qrcodeApi",function(){return i});var o=n("./src/utils.ts"),r=n("./src/client/proxy.ts");const i={login(t){if("ontid"!==t.type&&"account"!==t.type)throw new Error("Invalid parameter type "+t.type);const e={action:"login",version:r.version,id:Object(o.randomId)(),params:t};return JSON.stringify(e)},invoke(t){const e={action:"invoke",version:r.version,id:Object(o.randomId)(),params:t};return JSON.stringify(e)}}},"./src/client/smartcontract.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"scApi",function(){return i});var o=n("./src/utils.ts"),r=n("./src/client/proxy.ts");const i={invoke(t){if(!t.scriptHash||!t.operation||!t.args)throw new Error("Invalid params.");if(!t.payer)throw new Error("No payer.");t.config||(t.config={login:!0,message:"",url:""});const e=Object(o.makeInvokeFunction)(t.operation,t.args),n={action:"invoke",version:r.version,params:{login:t.config.login,url:t.config.url,message:t.config.message,invokeConfig:{contractHash:t.scriptHash,functions:[e],payer:t.payer,gasPrice:t.gasPrice?t.gasPrice:500,gasLimit:t.gasLimit?t.gasLimit:2e4}}};return Object(r.call)(n)},invokeRead(t){if(!t.scriptHash||!t.operation||!t.args)throw new Error("Invalid params.");t.config||(t.config={login:!0,message:"",url:""});const e=Object(o.makeInvokeFunction)(t.operation,t.args),n={action:"invokeRead",version:r.version,params:{login:t.config.login,url:t.config.url,message:t.config.message,invokeConfig:{contractHash:t.scriptHash,functions:[e],payer:t.payer,gasPrice:t.gasPrice?t.gasPrice:500,gasLimit:t.gasLimit?t.gasLimit:2e4}}};return Object(r.call)(n)},invokePasswordFree(t){if(!t.scriptHash||!t.operation||!t.args||0===t.args.length)throw new Error("Invalid params.");if(!t.payer)throw new Error("No payer.");t.config||(t.config={login:!0,message:"",url:""});const e=Object(o.makeInvokeFunction)(t.operation,t.args),n={action:"invokePasswordFree",version:r.version,params:{login:t.config.login,url:t.config.url,message:t.config.message,invokeConfig:{contractHash:t.scriptHash,functions:[e],payer:t.payer,gasPrice:t.gasPrice?t.gasPrice:500,gasLimit:t.gasLimit?t.gasLimit:2e4}}};return Object(r.call)(n)}}},"./src/index.ts":function(t,e,n){"use strict";n.r(e);var o=n("./src/client/index.ts");n.d(e,"client",function(){return o})},"./src/utils.ts":function(t,e,n){"use strict";function o(t){if("Boolean"===t.type||"Integer"===t.type)return{name:t.name,value:t.value};if("String"===t.type||"ByteArray"===t.type||"Long"===t.type||"Address"===t.type)return{name:t.name,value:t.type+":"+t.value};if("Array"===t.type)return{name:t.name,value:t.value.map(t=>o(t))};if("Map"===t.type){const e={};for(const n of Object.keys(t.value))e[n]=o(t.value[n]);return{name:t.name,value:e}}throw new Error("Invalid parmeter type: "+JSON.stringify(t))}function r(t,e){const n=[];for(const t of e)n.push(o(t));return{operation:t,args:n}}function i(){return Math.random().toString(36).substring(2,10)}function c(t){if("undefined"==typeof document)throw new Error("document-ready only runs in the browser");const e=document.readyState;if("complete"===e||"interactive"===e)return setTimeout(t,0);document.addEventListener("DOMContentLoaded",function(){t()})}n.r(e),n.d(e,"formatArgItem",function(){return o}),n.d(e,"makeInvokeFunction",function(){return r}),n.d(e,"randomId",function(){return i}),n.d(e,"ready",function(){return c})}})},{}],Utils:[function(t,e,n){"use strict";cc._RF.push(e,"b14489eLslLDoXF3wDzRla8","Utils"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){}return t.hexstring2ab=function(t){for(var e=[];t.length>=2;)e.push(parseInt(t.substring(0,2),16)),t=t.substring(2,t.length);return e},t.ab2str=function(t){return String.fromCharCode.apply(null,new Uint8Array(t))},t.toUtf8=function(t){return this.ab2str(this.hexstring2ab(t))},t}();n.utils=o,cc._RF.pop()},{}],bitcoin:[function(t,e,n){"use strict";cc._RF.push(e,"3c6589iWNBEW5WMg/NRVKCr","bitcoin");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,c=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(c=(i<3?r(c):i>3?r(e,n,c):r(e,n))||c);return i>3&&c&&Object.defineProperty(e,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});var i=cc._decorator,c=i.ccclass,s=i.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eatRadius=0,e.game=null,e}return o(e,t),e.prototype.update=function(t){if(this.getOntDistance()<this.eatRadius)this.onPicked();else{var e=1-this.game.timer/this.game.showDuration;this.node.opacity=50+Math.floor(205*e)}},e.prototype.getOntDistance=function(){if(this.game){var t=this.game.ontologyer.getPosition();return this.node.position.sub(t).mag()}return Number.MAX_SAFE_INTEGER.toFixed(2)},e.prototype.onPicked=function(){this.game.newBitCoin(),this.game.gainScore(),this.node.destroy()},r([s],e.prototype,"eatRadius",void 0),r([s(cc.Node)],e.prototype,"game",void 0),e=r([c],e)}(cc.Component);n.default=a,cc._RF.pop()},{}],gameOnchainMobile:[function(t,e,n){"use strict";cc._RF.push(e,"50813b9ilpMbpiSMz75M40L","gameOnchainMobile");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,c=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(c=(i<3?r(c):i>3?r(e,n,c):r(e,n))||c);return i>3&&c&&Object.defineProperty(e,n,c),c},i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function c(t){try{a(o.next(t))}catch(t){i(t)}}function s(t){try{a(o.throw(t))}catch(t){i(t)}}function a(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(c,s)}a((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return a([t,e])}}function a(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=e.call(t,c)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=cc._decorator,a=s.ccclass,u=s.property,l=t("cyanobridge"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ontologyer=null,e.bitCoinPreFab=null,e.maxCoinShowTime=0,e.minCoinShowTime=0,e.groundY=0,e.score=0,e.scoreLabel=null,e.timer=0,e.showDuration=0,e.scoreAudio=null,e}return o(e,t),e.prototype.onLoad=function(){return i(this,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:this.score=0,this.timer=0,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,l.client.registerClient()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),console.log(t),[3,4];case 4:return this.newBitCoin(),[2]}})})},e.prototype.start=function(){},e.prototype.newBitCoin=function(){var t=cc.instantiate(this.bitCoinPreFab);this.node.addChild(t),t.setPosition(this.getNewCoinPostion()),t.getComponent("bitcoin").game=this,this.showDuration=this.minCoinShowTime+Math.random()*(this.maxCoinShowTime-this.minCoinShowTime),this.timer=0},e.prototype.getNewCoinPostion=function(){var t,e=this.groundY+Math.random()*this.ontologyer.getComponent("ontologyer").jumpHeight+50,n=this.node.width/2;return t=2*(Math.random()-.5)*n,cc.v2(t,e)},e.prototype.getAcountAddress=function(){return i(this,void 0,void 0,function(){var t,e;return c(this,function(n){switch(n.label){case 0:return[4,l.client.api.asset.getAccount({dappName:"Bitcoin Catcher",dappIcon:""})];case 1:return t=n.sent(),e="",0===t.error&&(e=t.result),[2,e]}})})},e.prototype.update=function(t){return i(this,void 0,void 0,function(){var e=this;return c(this,function(n){switch(n.label){case 0:return this.timer>this.showDuration?[4,Alert.show("Score: "+this.score+"\n Do you want to upload score into blockchain?",function(t){return i(e,void 0,void 0,function(){var t,e,n,o;return c(this,function(r){switch(r.label){case 0:return[4,this.getAcountAddress()];case 1:t=r.sent(),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,l.client.api.smartContract.invoke({scriptHash:Globals.contractAddress,operation:"update_score",args:[{type:"String",value:t},{type:"Integer",value:this.score}],gasPrice:Globals.gasPrice,gasLimit:Globals.gasLimit,payer:t})];case 3:return 0===(e=r.sent()).error?(n=e.result,Alert.show("TxHash:"+n,function(){cc.director.loadScene("BitcoinCatcherOnchainMobile")},function(){cc.director.loadScene("IndexMobile")})):cc.director.loadScene("IndexMobile"),[3,5];case 4:return o=r.sent(),console.log(o),cc.director.loadScene("IndexMobile"),[3,5];case 5:return[2]}})})},this.loadIndex)]:[3,2];case 1:n.sent(),this.ontologyer.stopAllActions(),this.ontologyer.active=!1;try{this.node.getChildByName("bitcoin").active=!1}catch(t){console.log(t)}return this.enabled=!1,[2];case 2:return this.timer+=t,[2]}})})},e.prototype.loadIndex=function(){return i(this,void 0,void 0,function(){return c(this,function(t){return cc.director.loadScene("IndexMobile"),[2]})})},e.prototype.gainScore=function(){this.score+=1,this.scoreLabel.string="Score: "+this.score,cc.audioEngine.playEffect(this.scoreAudio,!1)},r([u(cc.Node)],e.prototype,"ontologyer",void 0),r([u(cc.Prefab)],e.prototype,"bitCoinPreFab",void 0),r([u(cc.Float)],e.prototype,"maxCoinShowTime",void 0),r([u(cc.Float)],e.prototype,"minCoinShowTime",void 0),r([u(cc.Float)],e.prototype,"groundY",void 0),r([u(cc.Float)],e.prototype,"score",void 0),r([u(cc.Label)],e.prototype,"scoreLabel",void 0),r([u(cc.Float)],e.prototype,"timer",void 0),r([u(cc.Float)],e.prototype,"showDuration",void 0),r([u({type:cc.AudioClip})],e.prototype,"scoreAudio",void 0),e=r([a],e)}(cc.Component);n.default=p,cc._RF.pop()},{cyanobridge:1}],gameOnchain:[function(t,e,n){"use strict";cc._RF.push(e,"9b25457cyhF9qq9oSKj3NvW","gameOnchain"),cc._RF.pop()},{}],game:[function(t,e,n){"use strict";cc._RF.push(e,"2f543k4XI9JmJN6Eg+OIZIo","game");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,c=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(c=(i<3?r(c):i>3?r(e,n,c):r(e,n))||c);return i>3&&c&&Object.defineProperty(e,n,c),c},i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function c(t){try{a(o.next(t))}catch(t){i(t)}}function s(t){try{a(o.throw(t))}catch(t){i(t)}}function a(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(c,s)}a((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return a([t,e])}}function a(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=e.call(t,c)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=cc._decorator,a=s.ccclass,u=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ontologyer=null,e.bitCoinPreFab=null,e.maxCoinShowTime=0,e.minCoinShowTime=0,e.groundY=0,e.score=0,e.scoreLabel=null,e.timer=0,e.showDuration=0,e.scoreAudio=null,e}return o(e,t),e.prototype.onLoad=function(){return i(this,void 0,void 0,function(){return c(this,function(t){return this.score=0,this.timer=0,this.newBitCoin(),[2]})})},e.prototype.start=function(){},e.prototype.newBitCoin=function(){var t=cc.instantiate(this.bitCoinPreFab);this.node.addChild(t),console.log(this.node),t.setPosition(this.getNewCoinPostion()),t.getComponent("bitcoin").game=this,this.showDuration=this.minCoinShowTime+Math.random()*(this.maxCoinShowTime-this.minCoinShowTime),this.timer=0},e.prototype.getNewCoinPostion=function(){var t,e=this.groundY+Math.random()*this.ontologyer.getComponent("ontologyer").jumpHeight+50,n=this.node.width/2;return t=2*(Math.random()-.5)*n,cc.v2(t,e)},e.prototype.update=function(t){if(this.timer>this.showDuration){Alert.show("Score: "+this.score,this.loadGame,this.loadIndex),this.ontologyer.stopAllActions(),this.ontologyer.active=!1;try{this.node.getChildByName("bitcoin").active=!1}catch(t){console.log(t)}this.enabled=!1}else this.timer+=t},e.prototype.loadIndex=function(){cc.director.loadScene("Index")},e.prototype.loadGame=function(){cc.director.loadScene("BitcoinCatcher")},e.prototype.gainScore=function(){this.score+=1,this.scoreLabel.string="Score: "+this.score,cc.audioEngine.playEffect(this.scoreAudio,!1)},r([u(cc.Node)],e.prototype,"ontologyer",void 0),r([u(cc.Prefab)],e.prototype,"bitCoinPreFab",void 0),r([u(cc.Float)],e.prototype,"maxCoinShowTime",void 0),r([u(cc.Float)],e.prototype,"minCoinShowTime",void 0),r([u(cc.Float)],e.prototype,"groundY",void 0),r([u(cc.Float)],e.prototype,"score",void 0),r([u(cc.Label)],e.prototype,"scoreLabel",void 0),r([u(cc.Float)],e.prototype,"timer",void 0),r([u(cc.Float)],e.prototype,"showDuration",void 0),r([u({type:cc.AudioClip})],e.prototype,"scoreAudio",void 0),e=r([a],e)}(cc.Component);n.default=l,cc._RF.pop()},{}],indexMobile:[function(t,e,n){"use strict";cc._RF.push(e,"a3280T+yhdMpoO9Gnfl2Bli","indexMobile");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,c=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(c=(i<3?r(c):i>3?r(e,n,c):r(e,n))||c);return i>3&&c&&Object.defineProperty(e,n,c),c},i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function c(t){try{a(o.next(t))}catch(t){i(t)}}function s(t){try{a(o.throw(t))}catch(t){i(t)}}function a(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(c,s)}a((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return a([t,e])}}function a(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=e.call(t,c)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=cc._decorator,a=s.ccclass,u=s.property,l=t("cyanobridge"),p=t("./utils"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playButton=null,e.scoreButton=null,e.walletExist=!1,e.withBlockchain=!0,e}return o(e,t),e.prototype.onLoad=function(){return i(this,void 0,void 0,function(){var t=this;return c(this,function(e){switch(e.label){case 0:Alert.show("Do you want to play this game in blockchain?",function(e){t.withBlockchain=!0},function(e){t.withBlockchain=!1}),e.label=1;case 1:return e.trys.push([1,4,,5]),[4,l.client.registerClient()];case 2:return e.sent(),[4,l.client.api.asset.getAccount()];case 3:return e.sent(),this.walletExist=!0,[3,5];case 4:return e.sent(),this.walletExist=!1,[3,5];case 5:return!0===this.withBlockchain&&!1===this.walletExist&&Alert.show("If you want to play with blockchain, please open it in ONTO.",function(){cc.sys.openURL("https://onto.app/")},function(e){t.withBlockchain=!1}),this.playButton.node.on("click",this.startScene,this),this.scoreButton.node.on("click",this.startScene,this),[2]}})})},e.prototype.startScene=function(t){return i(this,void 0,void 0,function(){var e,n,o,r,s=this;return c(this,function(a){switch(a.label){case 0:switch(t.node.name){case"playButton":return[3,1];case"scoreButton":return[3,8]}return[3,15];case 1:return!1===this.withBlockchain?(cc.director.loadScene("BitcoinCatcher"),[3,16]):!1!==this.walletExist?[3,3]:[4,Alert.show("Do you want to play it without blockchain?",function(t){s.withBlockchain=!1,cc.director.loadScene("BitcoinCatcher")},function(t){s.withBlockchain=!0})];case 2:return a.sent(),[3,16];case 3:e="",a.label=4;case 4:return a.trys.push([4,6,,7]),[4,this.getUserName()];case 5:return e=a.sent(),[3,7];case 6:return n=a.sent(),console.log(n),[3,7];case 7:return 1===e.length?(Alert.show("Let's register first.",function(t){return i(s,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,this.register()];case 1:return t.sent(),[2]}})})}),[2]):(Alert.show("Welcome "+e,function(){cc.director.loadScene("BitcoinCatcherOnchainMobile")}),[3,16]);case 8:return!1!==this.withBlockchain?[3,10]:[4,Alert.show("Do you want to use blockchain part?",function(t){s.withBlockchain=!0},function(t){s.withBlockchain=!1})];case 9:return a.sent(),[3,16];case 10:return!1!==this.walletExist?[3,12]:[4,Alert.show("Please install ONTO first if you want to unlock blockchain part.",function(){cc.sys.openURL("https://onto.app/")})];case 11:return a.sent(),[3,16];case 12:return[4,this.getScore()];case 13:return o=a.sent(),[4,this.getAcountAddress()];case 14:return r=a.sent(),Alert.show("Address:\n"+r+"\n\nScore: "+o,null,null,!1),[3,16];case 15:return[3,16];case 16:return[2]}})})},e.prototype.getAcountAddress=function(){return i(this,void 0,void 0,function(){var t,e;return c(this,function(n){switch(n.label){case 0:return[4,l.client.api.asset.getAccount({dappName:"Bitcoin Catcher",dappIcon:""})];case 1:return t=n.sent(),e="",0===t.error&&(e=t.result),[2,e]}})})},e.prototype.getUserName=function(){return i(this,void 0,void 0,function(){var t,e,n;return c(this,function(o){switch(o.label){case 0:return[4,this.getAcountAddress()];case 1:t=o.sent(),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,l.client.api.smartContract.invokeRead({scriptHash:Globals.contractAddress,operation:"get_user_name",args:[{type:"String",value:t}],gasPrice:Globals.gasPrice,gasLimit:Globals.gasLimit})];case 3:return 0!==(e=o.sent()).error?[2,""]:[2,p.utils.toUtf8(e.result.Result)];case 4:return n=o.sent(),console.log(n),[2,""];case 5:return[2]}})})},e.prototype.getScore=function(){return i(this,void 0,void 0,function(){var t,e,n,o;return c(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),[4,this.getAcountAddress()];case 1:return t=r.sent(),[4,l.client.api.smartContract.invokeRead({scriptHash:Globals.contractAddress,operation:"get_score",args:[{type:"String",value:t}],gasPrice:Globals.gasPrice,gasLimit:Globals.gasLimit})];case 2:return 0===(e=r.sent()).error?[3,4]:[4,Alert.show(e.result,null,null,!1)];case 3:return r.sent(),[2,0];case 4:return""===(n=e.result.Result)&&(n=0),[2,parseInt(n,16)];case 5:return o=r.sent(),console.log(o),[2,0];case 6:return[2]}})})},e.prototype.register=function(){return i(this,void 0,void 0,function(){var t,e,n,o;return c(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,this.getAcountAddress()];case 1:return t=r.sent(),[4,l.client.api.smartContract.invoke({scriptHash:Globals.contractAddress,operation:"register",args:[{type:"String",value:t},{type:"String",value:"NashMiao"}],gasPrice:Globals.gasPrice,gasLimit:Globals.gasLimit,payer:t})];case 2:return 0===(e=r.sent()).error&&(n=e.result,Alert.show("TxHash:"+n,function(){cc.director.loadScene("BitcoinCatcherOnchainMobile")})),[3,4];case 3:return o=r.sent(),console.log(o),[3,4];case 4:return[2]}})})},r([u(cc.Button)],e.prototype,"playButton",void 0),r([u(cc.Button)],e.prototype,"scoreButton",void 0),e=r([a],e)}(cc.Component);n.default=h,cc._RF.pop()},{"./utils":"Utils",cyanobridge:1}],index:[function(t,e,n){"use strict";cc._RF.push(e,"fc15d1Q7/pCxYMUjwUCtFiN","index"),cc._RF.pop()},{}],ontologyer:[function(t,e,n){"use strict";cc._RF.push(e,"2d0f28kKE5Bx5sYwu6WW79l","ontologyer");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,c=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(c=(i<3?r(c):i>3?r(e,n,c):r(e,n))||c);return i>3&&c&&Object.defineProperty(e,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});var i=cc._decorator,c=i.ccclass,s=i.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.jumpHeight=0,e.jumpDuration=0,e.squashDuration=0,e.maxSpeed=0,e.xSpeed=0,e.acceleration=0,e.accLeft=!1,e.accRight=!1,e.jumpAudio=null,e}return o(e,t),e.prototype.onLoad=function(){var t=this.setJumpAction();this.node.runAction(t),this.xSpeed=0,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this);var e=cc.Canvas.instance.node;e.on("touchstart",this.onTouchStart,this),e.on("touchend",this.onTouchEnd,this)},e.prototype.onDestroy=function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this);var t=cc.Canvas.instance.node;t.off("touchstart",this.onTouchStart,this),t.off("touchend",this.onTouchEnd,this)},e.prototype.onTouchStart=function(t){t.getLocation().x>=cc.winSize.width/2?(this.accLeft=!1,this.accRight=!0):(this.accLeft=!0,this.accRight=!1)},e.prototype.onTouchEnd=function(t){this.accLeft=!1,this.accRight=!1},e.prototype.setJumpAction=function(){var t=cc.moveBy(this.jumpDuration,cc.v2(0,this.jumpHeight)).easing(cc.easeCubicActionOut()),e=cc.moveBy(this.jumpDuration,cc.v2(0,-this.jumpHeight)).easing(cc.easeCubicActionIn()),n=cc.scaleTo(this.squashDuration,1,.6),o=cc.scaleTo(this.squashDuration,1,1.2),r=cc.scaleTo(this.squashDuration,1,1),i=cc.callFunc(this.playJumpSound,this);return cc.repeatForever(cc.sequence(n,o,r,t,e,i))},e.prototype.playJumpSound=function(){cc.audioEngine.playEffect(this.jumpAudio,!1)},e.prototype.onKeyDown=function(t){switch(t.keyCode){case cc.macro.KEY.a:case cc.macro.KEY.left:this.accLeft=!0;break;case cc.macro.KEY.d:case cc.macro.KEY.right:this.accRight=!0}},e.prototype.onKeyUp=function(t){switch(t.keyCode){case cc.macro.KEY.a:case cc.macro.KEY.left:this.accLeft=!1;break;case cc.macro.KEY.d:case cc.macro.KEY.right:this.accRight=!1}},e.prototype.update=function(t){this.accLeft?this.xSpeed-=this.acceleration*t:this.accRight&&(this.xSpeed+=this.acceleration*t),Math.abs(this.xSpeed)>this.maxSpeed&&(this.xSpeed=this.maxSpeed*this.xSpeed/Math.abs(this.xSpeed)),this.node.x+=this.xSpeed*t,this.node.x>this.node.parent.width/2?(this.node.x=this.node.parent.width/2,this.xSpeed=0):this.node.x<-this.node.parent.width/2&&(this.node.x=-this.node.parent.width/2,this.xSpeed=0)},r([s(cc.Float)],e.prototype,"jumpHeight",void 0),r([s(cc.Float)],e.prototype,"jumpDuration",void 0),r([s(cc.Float)],e.prototype,"squashDuration",void 0),r([s(cc.Float)],e.prototype,"maxSpeed",void 0),r([s(cc.Float)],e.prototype,"xSpeed",void 0),r([s(cc.Float)],e.prototype,"acceleration",void 0),r([s(cc.Boolean)],e.prototype,"accLeft",void 0),r([s(cc.Boolean)],e.prototype,"accRight",void 0),r([s({type:cc.AudioClip})],e.prototype,"jumpAudio",void 0),e=r([c],e)}(cc.Component);n.default=a,cc._RF.pop()},{}],"use_v2.1.x_cc.Action":[function(t,e,n){"use strict";cc._RF.push(e,"953ccTFUX1M3rnilU8yyOaH","use_v2.1.x_cc.Action"),cc.macro.ROTATE_ACTION_CCW=!0,cc._RF.pop()},{}]},{},["Utils","bitcoin","game","gameOnchain","gameOnchainMobile","index","indexMobile","ontologyer","use_v2.1.x_cc.Action"]);